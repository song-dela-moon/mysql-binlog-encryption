# MySQL 8.0 Binary Log Encryption Performance Analysis

λ³Έ ν”„λ΅μ νΈλ” MySQL 8.0μ **Binary Log Encryption (Data-at-Rest)** κΈ°λ¥μ„ ν™μ„±ν™”ν–μ„ λ•, λ³΄μ• κ°•ν™” μμΉμ™€ μ‹μ¤ν… μ„±λ¥(Throughput, Latency) μ‚¬μ΄μ νΈλ μ΄λ“μ¤ν”„λ¥Ό μ‹¤μ¦μ μΌλ΅ λ¶„μ„ν• μ—°κµ¬μ…λ‹λ‹¤.

## 1. μ‹¤ν— λ©μ  (Objectives)
- **λ³΄μ•μ„± κ²€μ¦**: λ””μ¤ν¬ λ λ²¨μ—μ„ λ°”μ΄λ„λ¦¬ λ΅κ·Έκ°€ λ¬Όλ¦¬μ μΌλ΅ μ•”νΈν™”λμ–΄ μ§μ ‘ μ΅°μ‘ λ° μ μ¶μ΄ λ¶κ°€λ¥ν•μ§€ ν™•μΈ.
- **μ„±λ¥ μ„ν©νΈ λ¶„μ„**: AES-NI ν•λ“μ›¨μ–΄ κ°€μ† ν™κ²½μ—μ„ μ•”νΈν™” μ—°μ‚°μ΄ μ‹¤μ  νΈλμ­μ… μ²λ¦¬λ‰(TPS)μ— λ―ΈμΉλ” μν–¥μ„ μΈ΅μ •.
- **λ³‘λ© μ§€μ  νμ•…**: I/O Bound ν™κ²½κ³Ό CPU μ—°μ‚° μ‚¬μ΄μ μƒκ΄€κ΄€κ³„λ¥Ό λ¶„μ„ν•μ—¬ μµμ μ λ³΄μ• μ„¤μ • λ„μ¶.

## 2. μ‹¤ν— ν™κ²½ (Environment)
- **OS**: Ubuntu 24.04 LTS (Master-Replica κµ¬μ΅°)
- **DB**: MySQL 8.0.45
- **Hardware**: AES-NI κ°€μ† μ§€μ› CPU, κ°€μƒν™” λ””μ¤ν¬(I/O Bound ν™κ²½)
- **Benchmark Tool**: `sysbench 1.0.20` (OLTP Read/Write μ›ν¬λ΅λ“)

## 3. μ‹¤ν— κ²°κ³Ό (Benchmark Data)

4 Threads ν™κ²½μ—μ„ 10λ¶„(300s) λ™μ• μ¥κΈ° λ¶€ν• ν…μ¤νΈλ¥Ό μν–‰ν• κ²°κ³Όμ…λ‹λ‹¤.

| μΈ΅μ • μ§€ν‘ (Metric) | Scenario A (Encryption OFF) | Scenario B (Encryption ON) | λΉ„κ³  |
|:---:|:---:|:---:|:---:|
| **TPS (Transactions/sec)** | **221.19** | **229.41** | **μ¤μ°¨ λ²”μ„ λ‚΄ μ μ‚¬** |
| **QPS (Queries/sec)** | **4,423.75** | **4,588.15** | **μ μ‚¬** |
| **Avg Latency** | **18.07 ms** | **17.43 ms** | **μ μ‚¬** |
| **Max Latency** | **274.03 ms** | **316.57 ms** | **π”Ί 15.5% μƒμΉ (Spike)** |

---
> **[μ΄λ―Έμ§€ μ‚½μ…: μ•”νΈν™” μ μ© μ „ν›„μ TPS λΉ„κµ λ§‰λ€ κ·Έλν”„]**
---
> **[μ΄λ―Έμ§€ μ‚½μ…: Max Latencyκ°€ ν€λ” ν„μƒμ„ λ³΄μ—¬μ£Όλ” κ²°κ³Ό λ΅κ·Έ μΊ΅μ²]**
---

## 4. ν•µμ‹¬ λ¶„μ„ (Technical Insights)

### μ™ μ„±λ¥ μ°¨μ΄κ°€ λ―Έλ―Έν•κ°€?
1. **I/O Bound λ³‘λ©**: κ°€μƒν™” ν™κ²½μ λ””μ¤ν¬ μ“°κΈ° μ†λ„κ°€ μ‹μ¤ν…μ μ „μ²΄ μ„±λ¥μ„ μ ν•ν•κ³  μμµλ‹λ‹¤. CPUκ°€ μ•”νΈν™” μ—°μ‚°μ„ μν–‰ν•λ” μ‹κ°„λ³΄λ‹¤ λ””μ¤ν¬ μ“°κΈ° λ€κΈ° μ‹κ°„μ΄ ν›¨μ”¬ κΈΈκΈ° λ•λ¬Έμ— μ•”νΈν™” μ¤λ²„ν—¤λ“κ°€ μ™Έκ²¬μƒ κ°€λ ¤μ§€λ” ν„μƒμ΄ λ‚νƒ€λ‚©λ‹λ‹¤.
2. **AES-NI κ°€μ†**: ν„λ€ CPUμ ν•λ“μ›¨μ–΄ μ•”νΈν™” κ°€μ† κΈ°λ¥μ„ ν†µν•΄ μ—°μ‚° λΉ„μ©μ„ μµμ†ν™”ν–μµλ‹λ‹¤.
3. **Max Latencyμ μλ―Έ**: ν‰κ·  μμΉλ” λΉ„μ·ν•λ‚, μµλ€ μ§€μ—° μ‹κ°„μ΄ μ•½ 15% μƒμΉν–μµλ‹λ‹¤. μ΄λ” λ¶€ν•κ°€ λ°λ¦΄ λ• CPU μ¤μΌ€μ¤„λ§ κ²½ν•©μ΄ λ°μƒν•λ©° μ•”νΈν™” μ—°μ‚°μ΄ μ‘λ‹µ μ‹κ°„μ— κ°„ν—μ μΈ μν–¥μ„ λ―ΈμΉλ‹¤λ” μ¦κ±°μ…λ‹λ‹¤.

## 5. λ„λ©”μΈλ³„ κ¶μ¥ μ „λµ (Strategy)

| λ„λ©”μΈ | κ¶μ¥ μ„¤μ • | μ‚¬μ  |
|:---:|:---:|:---|
| **κΈμµ/μλ£** | **ν•„μ** | μ μ¶ μ‹ λ²•μ  νƒ€κ²©μ΄ λ§‰λ€ν•λ©°, μ„±λ¥λ³΄λ‹¤ λ³΄μ•μ„±μ΄ μ°μ„ λ¨. |
| **μ„λΉ„μ¤** | **κ¶μ¥** | AES-NI ν™κ²½μ—μ„λ” μ„±λ¥ μ €ν•κ°€ λ―Έλ―Έν•λ―€λ΅ μ μ©ν•λ” κ²ƒμ΄ μ λ¦¬ν•¨. |

## 6. μ‚¬μ© λ°©λ²• (How to Reproduce)

1. **Keyring μ„¤μ • λ° μ•”νΈν™” ν™μ„±ν™”**
   `/etc/mysql/mysql.conf.d/mysqld.cnf`μ— λ‹¤μ μ„¤μ • μ¶”κ°€ ν›„ μ¬μ‹μ‘:
   ```ini
   early-plugin-load = keyring_file.so
   keyring_file_data = /var/lib/mysql-keyring/keyring
   binlog_encryption = ON
